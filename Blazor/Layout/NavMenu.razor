@using Microsoft.AspNetCore.Components
@using Microsoft.AspNetCore.Components.Routing
@using Microsoft.AspNetCore.Components.Authorization
@inject NavigationManager NavManager

@* Topnavigation *@

<header class="nav">
    <div class="nav-inner container">
        <a class="brand" href="/" aria-label="JoHotel forside">
            <svg width="34" height="34" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <defs>
                    <linearGradient id="ghead" x1="0" y1="0" x2="1" y2="1">
                        <stop offset="0%" stop-color="#E8E0D5" />
                        <stop offset="100%" stop-color="#C8A96B" />
                    </linearGradient>
                </defs>
                <circle cx="18" cy="18" r="16" stroke="url(#ghead)" stroke-width="1.5" />
                <path d="M10 22c3.8-1.2 7.2-6.2 8.1-12.1 1 5.9 4.3 10.9 8.1 12.1-3.5.9-7.1 4.2-8.1 8.1-1-3.9-4.6-7.2-8.1-8.1Z"
                      stroke="url(#ghead)" stroke-width="1.1" fill="none" />
            </svg>
            <span class="brand-text">JoHotel</span>
        </a>

        @* Hovedlinks *@

        <nav class="links @(isOpen ? "open" : string.Empty)">
            <NavLink href="/" Match="NavLinkMatch.All">Forside</NavLink>
            <NavLink href="/rooms">Værelser</NavLink>
            <NavLink href="/offers">Tilbud</NavLink>
            <NavLink href="/dining">Dining</NavLink>
            <NavLink href="/spa">Spa</NavLink>
            <NavLink href="/about">Om os</NavLink>
        </nav>

        @* Login/Profil + burger *@

        <div class="actions">
            <AuthorizeView>
                <NotAuthorized>
                    <a class="btn-outline" href="/login">Log ind</a>
                </NotAuthorized>

                <Authorized Context="auth">
                    @{
                        var user = auth.User;
                        string displayName =
                        user?.FindFirst("name")?.Value
                        ?? user?.FindFirst("unique_name")?.Value
                        ?? user?.FindFirst("http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name")?.Value
                        ?? user?.Identity?.Name
                        ?? "Min profil";
                    }
                    <a class="btn-outline" href="/mybookings">Mine bookninger</a>
                    <a class="btn btn-gold" href="/user">@displayName</a>
                </Authorized>
            </AuthorizeView>

            <button class="hamburger" @onclick="ToggleMenu" aria-label="Åbn/luk menu">
                <span></span><span></span><span></span>
            </button>
        </div>
    </div>
</header>

@code {
    private bool isOpen;
    void ToggleMenu() => isOpen = !isOpen;
}